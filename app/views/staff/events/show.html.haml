.event
  .row
    .col-md-12
      .page-header
        %h1= event
  .row
    .col-sm-4
      .widget.widget-table
        .widget-header
          %i.fa.fa-calendar
          %h3 Event Details
        .widget-content
          %table.table.table-striped.table-bordered
            %tbody
              %tr
                %td.text-primary
                  %strong Url:
                %td
                  %a{ href: event.url }#{event.url}
              %tr
                %td.text-primary
                  %strong Slug:
                %td #{event.slug}
              %tr
                %td.text-primary
                  %strong Email:
                %td #{event.contact_email}
              %tr
                %td.text-primary
                  %strong Guidelines:
                %td
                  -if event.guidelines.present?
                    = event.guidelines.truncate(150, separator: /\s/)
                  %p= link_to "View Public Guidelines", event_path(slug: event.slug), class: "btn btn-success"

                  - if current_user.can_edit?
                    %p= link_to "<i class='fa fa-pencil'></i> Edit Guidelines".html_safe, event_staff_guidelines_notifications_path, class: "btn btn-primary"

      .widget.widget-table
        .widget-header
          %i.fa.fa-calendar
          %h3 CFP Details
        .widget-content
          %table.table.table-striped.table-bordered
            %tbody
              %tr
                %td.text-primary
                  %strong CFP Opens:
                %td= event.cfp_opens
              %tr
                %td.text-primary
                  %strong CFP Closes:
                %td= event.cfp_closes

              %tr
                %td.text-primary
                  %strong Days Remaining:
                %td #{event.cfp_days_remaining}

              %tr
                %td.text-primary
                  %strong Event Start:
                %td #{event.start_date.to_s(:month_day_year) unless event.start_date.blank?}

              %tr
                %td.text-primary
                  %strong Event End:
                %td #{event.end_date.to_s(:month_day_year) unless event.end_date.blank?}


    .col-sm-4
      .widget
        .widget-header
          %i.fa.fa-list-alt
          %h3 Proposal Stats
        .widget-content
          .row
            .col-sm-12
              %h4
                %strong.text-primary Total:
                %span.label.label-info #{event.proposals.count}
          .row
            .col-sm-12
              %h4
                %strong.text-primary Reviewed:
                %span.label.label-info #{event.proposals.rated.count} (#{event.reviewed_percent})
          - if current_user.can_edit?
            .row
              .col-sm-12
                %h4
                  %strong.text-primary Accepted:
                  %span.label.label-info #{event.proposals.accepted.count}
            .row
              .col-sm-12
                %h4
                  %strong.text-primary Confirmed:
                  %span.label.label-info #{event.proposals.accepted.confirmed.count} (#{event.confirmed_percent})
            .row
              .col-sm-12
                %h4
                  %strong.text-primary Scheduled:
                  %span.label.label-info #{event.proposals.scheduled.count} (#{event.scheduled_percent})
            .row
              .col-sm-12
                %h4
                  %strong.text-primary Waitlisted:
                  %span.label.label-info #{event.proposals.waitlisted.count}
            .row
              .col-sm-12
                %h4
                  %strong.text-primary Confirmed:
                  %span.label.label-info #{event.proposals.waitlisted.confirmed.count} (#{event.waitlisted_percent})

      .widget
        .widget-header
          %i.fa.fa-tags
          %h3 Proposal Tags
        .widget-content
          =event.valid_proposal_tags

      .widget
        .widget-header
          %i.fa.fa-tags
          %h3 Review Tags
          - if current_user.can_edit?
            = link_to "<i class='fa fa-pencil'></i> Edit".html_safe, event_staff_edit_path, class: "btn btn-sm btn-primary pull-right"
        .widget-content
          =event.valid_review_tags

      .widget
        .widget-header
          %i.fa.fa-tags
          %h3 Fields
          - if current_user.can_edit?
            = link_to "<i class='fa fa-plus'></i> Add Custom Field".html_safe, event_staff_custom_fields_path(event), class: "btn btn-primary btn-sm pull-right"
        .widget-content
          %ul.list-unstyled
            %li
              %h5.text-primary
                %strong Standard
            %li
              %p=event.fields
          %hr/
          %ul.list-unstyled
            %li
              %h5.text-primary
                %strong Custom Fields
            %li
              %p=event.custom_fields.join(", ")

    .col-sm-4
      .widget
        .widget-header
          %i.fa.fa-tags
          %h3 Tracks
        .widget-content
          -if event.track_count.present?
            - event.track_count.sort_by{|k,v| v}.reverse.each_slice(8).to_a.each do |row|
              %ul#columns.list-inline
                -row.each do |name, count|
                  %li
                    .label.label-success
                      = name
                      = count
          -else
            %p No Tracks

      .widget
        .widget-header
          %i.fa.fa-tags
          %h3 Speaker Notifications
          - if current_user.can_edit?
            = link_to "<i class='fa fa-pencil'></i> Edit".html_safe, event_staff_speaker_email_notifications_path, class: "btn btn-sm btn-primary pull-right"
        .widget-content
          %ul.list-group
            %li.list-group-item
              %strong.text-primary Accept:
              %p=event.speaker_notification_emails['accept'].truncate(75, separator: /\s/)
            %li.list-group-item
              %strong.text-primary Reject:
              %p=event.speaker_notification_emails['reject'].truncate(75, separator: /\s/)
            %li.list-group-item
              %strong.text-primary Waitlist:
              %p=event.speaker_notification_emails['waitlist'].truncate(75, separator: /\s/)

  %hr/
  = render partial: 'event_teammates', locals: { event: event, event_teammates: event_teammates, rating_counts: rating_counts }
